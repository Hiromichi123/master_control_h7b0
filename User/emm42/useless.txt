#include <stdio.h>
#include "main.h"

#ifdef EMM42_DEBUG
UART_HandleTypeDef huart1 = 1;
#endif

emm42_motor motorA;


int main() {
    emmMotorUartInit(&motorA, &huart1, 0x01, 0x6B);
    emm42Enable(motorA, true);
    emm42SetSpeed(motorA, FORWARD, 0x2ff, 0);
    emm42SetPosition(motorA, BACK, 0x2ff, 0, 3200);
    emm42ReadEncoder(motorA);
    emm42ReadPosition(motorA);
    return 0;
}


#ifdef EMM42_DEBUG
UChar HexToAscii(UChar c){
    if(c > 9){
        return (c+55);     // 16进制 0A 对应的ascii 'A'，两者相差55  -- 可以比照ascii表理解
    }else{
        return (c+48);     // 16进制 01 对应的ascii '1'  两者相差48  -- 可以比照ascii表理解
    }
}

int printChar(UChar hexData[], int commandLength){
    UChar temp;
    UChar data[32] = {0};
    for(int i = 0; i < commandLength; i++){
        temp = hexData[i] & 0xf0;   // 取16进制数高位放到 HexToAscii 函数中转成字符
        *(data + i*3) = HexToAscii(temp >> 4);
        temp = hexData[i] & 0x0f;   // 取16进制数低位放到 HexToAscii 函数中转成字符
        *(data + i*3 + 1) = HexToAscii(temp);
        *(data + i*3 + 2) = ' ';  // 添加空格进行区分
    }
    printf("string is %s.\n",data);
    return 0;
}
#endif